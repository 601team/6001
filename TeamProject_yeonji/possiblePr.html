<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <title>SearchConsult</title>
</head>
<body>
    <div style="padding: 50px;"><h1>교수검색</h1></div>

    <div class="col">
      <table class="table table-striped" id='proTable'>
          <tbody>
              <tr>
                  <td>교수명</td>
                  <td>전공</td>
                  <td>연구실</td>
                  <td>이메일</td>
              </tr>
          </tbody>
      </table>
    </div>
    

    <div class="col">
    <table class="table table-striped" id='ConTimeTable'>
            <tbody>
              <tr>
                <td>상담 가능 요일</td>  
                <td>상담 가능 시간</td>
                <td>예약하기</td>
              </tr>
          </tbody>
      </table>

    
      
    </div>

      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>
    

    </body>
    
   
    </script>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.9.2/firebase-app.js";
        import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.9.2/firebase-analytics.js";
        import { getDatabase, ref, set, onValue } from "https://www.gstatic.com/firebasejs/9.9.2/firebase-database.js";
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyAVjfBhilux_3BIyx486cRR2dsybsseKA8",
            authDomain: "team-a5651.firebaseapp.com",
            databaseURL: "https://team-a5651-default-rtdb.firebaseio.com",
            projectId: "team-a5651",
            storageBucket: "team-a5651.appspot.com",
            messagingSenderId: "804446190852",
            appId: "1:804446190852:web:66473b851c3cfc1792e451"
        };
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        const dbRef = ref(database,'consultcheck/');
        
        $(document).ready(function() {
            $(".btCheck").on('click',function() { 
                var str = ""
                var tdArr = new Array();   // 배열 선언
                var checkBtn = $(this);
                
                // checkBtn.parent() : checkBtn의 부모는 <td>이다.
                // checkBtn.parent().parent() : <td>의 부모이므로 <tr>이다.
                var tr = checkBtn.parent().parent();
                var td = tr.children();
                
                console.log("클릭한 Row의 모든 데이터 : "+tr.text());
                
                var cDate = td.eq(0).text();
                var cTime = td.eq(1).text();
                
                
                // 반복문을 이용해서 배열에 값을 담아 사용할 수 도 있다.
                td.each(function(i){   
                    tdArr.push(td.eq(i).text());
                });
                
                console.log("배열에 담긴 값 : "+tdArr);
                
                str +=   " * 클릭된 Row의 td값 = No. : <font color='red'>" + cDate + "</font>" +
                        ", 아이디 : <font color='red'>" + cTime + "</font>";   
                // console.log(str);
                // console.log(cDate);
                // console.log(cTime);
                // sessionStorage.setItem('date',cDate);
                // sessionStorage.setItem('time',cTime);
                set(ref(database, 'consultcheck/' +sessionStorage.getItem('usermail')),{//학생 이메일
                    stumail : sessionStorage.getItem('usermail'),
                    promail : sessionStorage.getItem('proemail'),
                    date : cDate,
                    time : cTime,
                    state : "보류"
                })
                alert("저장됨")
                
            
            });
        });


        
        
        

    </script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="searchPr.js"></script>

</html>